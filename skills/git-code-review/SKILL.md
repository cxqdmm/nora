---
name: git-code-review
description: 分析暂存区或已提交的更改，并提供代码审查（Code Review）。
version: 1.0.0
---

# Git 代码审查 (Code Review) 技能

此技能帮助你审查 Git 仓库中的代码变更。它可以分析暂存区的更改或特定的提交，并针对代码质量、潜在 Bug、安全问题和代码风格提供反馈。

## 使用方法

当用户要求“审查代码”、“检查我的修改”或“CR”时，请遵循以下步骤：

1.  **确定范围**：判断用户想要审查的内容：
    -   暂存区的更改（默认）：使用 `git diff --cached`
    -   工作区的更改：使用 `git diff`
    -   特定提交：使用 `git show <commit-hash>`
    -   分支对比：使用 `git diff <target_branch>...<source_branch>` (例如 `git diff master...develop`)。如果用户只说“对比 master”，则默认为当前分支与 master 的差异。

2.  **获取变更**：执行相应的 Git 命令以获取 diff 内容。

3.  **分析**：审查 diff 内容，重点关注：
    -   **正确性**：逻辑错误、潜在 Bug、边界情况。
    -   **安全性**：漏洞、硬编码的密钥、不安全的输入处理。
    -   **可维护性**：代码风格、命名规范、复杂度、注释。
    -   **性能**：低效算法、不必要的循环或内存分配。

4.  **报告**：提供结构化的审查报告。
    -   **总结**：简要概述变更内容。
    -   **关键问题**：列出严重问题的要点（如果有）。
    -   **建议**：具体的改进建议。
    -   **评分**：（可选）主观评分或通过/不通过的建议。

## 示例

**用户：** “审查一下我暂存的代码。”
**Agent：**
1. 运行 `git diff --cached`
2. 分析输出。
3. 回复：“我已经审查了你对 `auth.ts` 的修改。整体看起来不错，但我注意到你在登录 API 中没有处理错误情况……”

**用户：** “CR 这个提交。”
**Agent：**
1. 询问提交哈希，或者如果上下文暗示是最新提交，则假设为 `HEAD`。
2. 运行 `git show HEAD`
3. 提供反馈。

**用户：** “Review 一下当前分支和 master 的差异。”
**Agent：**
1. 运行 `git diff master...HEAD` (或 `git diff master`)
2. 分析并提供反馈。
